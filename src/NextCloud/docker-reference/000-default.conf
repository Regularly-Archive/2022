<VirtualHost *:443>
	ServerName nextcloud.fgms.dev.com

	ServerAdmin webmaster@localhost
	DocumentRoot /var/www/html

	LogLevel debug

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined

	SSLEngine On
    SSLCertificateFile /etc/certs/nextcloud.crt
    SSLCertificateKeyFile /etc/certs/nextcloud.key

	<Location "/">
		AuthName "NextCloud SSO"
		AuthType Kerberos
		Krb5KeyTab "/etc/apache2/krb-container.keytab"
		KrbMethodNegotiate On
		KrbMethodK5Passwd On
		KrbSaveCredentials On
		KrbServiceName HTTP/nextcloud.fgms.dev.com
		KrbLocalUserMapping On
		Require valid-user

		RequestHeader set REMOTE_USER %{AUTHENTICATE_uid}s
		RequestHeader set AUTH_TYPE %{AUTH_TYPE}s
    	RequestHeader set KRB5CCNAME %{KRB5CCNAME}s
	</Location>
</VirtualHost>
